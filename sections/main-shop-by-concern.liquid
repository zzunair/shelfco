{% comment %}
  Shop by concern section
{% endcomment %}

<section
  id="{{ section.id }}"
  class="container wow fadeIn hero-header hero-container section-{{ section.id }}-padding"
  data-wow-delay="300ms"
>
  <div class="">
    <div class="hero-v4">
      <!-- Header -->
      <div class="col-md-12 mobile-ready-padding px-0">
        {% if section.settings.section_header != blank %}
          <div class="title pt-0 pb-0">
            <h2 class="text-left mb-3">
              {{ section.settings.section_header }}
            </h2>
          </div>
        {% endif %}
      </div>
      <!-- /Header -->
      <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 shop-by-concern-contents hero-wrapper home mobile-ready-padding px-0">
        <div class="split-content hero-content-left">
          <div class="shop-by-concern-content-items" data-sectionid="{{ section.id }}">
            {% for block in section.blocks %}
              <div class="shop-by-concern-content-item border-bottom" data-blockid="shop-by-concern-{{ block.id }}">
                {% if block.settings.content_title != blank %}
                  <h2 class="title shop-by-concern-hero-title mb-0">
                    {{ block.settings.content_title | escape }}
                  </h2>
                {% endif %}
                {% unless block.settings.content_button == blank %}
                  <div class="buttons-wrapper mb-0">
                    <a
                      href="{{ block.settings.content_url }}"
                      class="btn btn-contact"
                      aria-label="{{ block.settings.content_button }}"
                      tabindex="0"
                    >
                      {{ block.settings.content_button }}
                    </a>
                  </div>
                {% endunless %}
              </div>
            {% endfor %}
          </div>
        </div>
        <div class="grid-item-wrapper">
          {% for block in section.blocks %}
            <div id="shop-by-concern-{{ block.id }}" class="image-wrapper shop-by-concern-image hidden" data-test="{{ block.id }}">
              {% if block.settings.image == blank %}
                {{ 'product-3' | placeholder_svg_tag: 'placeholder-svg border-0 rounded__all' }}
              {% else %}
                {{
                  block.settings.image
                  | image_url: width: 2048
                  | image_tag:
                    class: 'image hero-v1 rounded__all border-0 img-fluid',
                    widths: '500, 800, 1000, 1200, 1500',
                    height: block.settings.image.height,
                    width: block.settings.image.width,
                    loading: 'lazy',
                    alt: block.settings.image.alt
                  | escape
                }}
              {% endif %}
            </div>
          {% endfor %}
          <div class="image-wrapper shop-by-concern-default-image" data-sectionid="{{ section.id }}">
            {% if section.settings.image == blank %}
              {{ 'product-3' | placeholder_svg_tag: 'placeholder-svg border rounded__all' }}
            {% else %}
              {{
                section.settings.image
                | image_url: width: 2048
                | image_tag:
                  class: 'image hero-v1 rounded__all border-0 img-fluid',
                  widths: '500, 800, 1000, 1200, 1500',
                  height: section.settings.image.height,
                  width: section.settings.image.width,
                  loading: 'lazy',
                  alt: section.settings.image.alt
                | escape
              }}
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Shop by concern",
  "class": "main-shop-by-concern",
  "max_blocks": 3,
  "settings": [
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 20
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 20
    },
    {
      "type": "text",
      "id": "section_header",
      "label": "Heading",
      "default": "Shop by concern"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Default image"
    }
  ],
  "blocks": [
    {
      "type": "image",
      "name": "Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Upload image",
          "info": "Recommended image 1000px by 1000px jpeg"
        },
        {
          "type": "text",
          "id": "content_title",
          "label": "Heading",
          "default": "Title"
        },
        {
          "type": "text",
          "id": "content_button",
          "label": "Button label",
          "default": "Button label"
        },
        {
          "type": "url",
          "id": "content_url",
          "label": "Link",
	        "default": "/collections/all"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Shop by concern",
      "category": "Content",
      "settings": {
      },
      "blocks": [
        {
         "type": "image",
         "settings": {
            "image": "",
            "content_title": "Heading"
          }
        },
        {
         "type": "image",
         "settings": {
            "image": "",
            "content_title": "Heading"
          }
        },
        {
         "type": "image",
         "settings": {
            "image": "",
            "content_title": "Heading"
          }
        }
      ]
    }
  ]
}
{% endschema %}

<script>
document.addEventListener("DOMContentLoaded", function() {
 shopByConcern();
});
document.addEventListener("shopify:section:load", function() {
  shopByConcern();
});
document.addEventListener("shopify:section:reorder", function() {
  shopByConcern();
});
function shopByConcern(){
  var items = document.querySelectorAll('.shop-by-concern-content-item');
  if (items.length > 0) {
    items.forEach(function(item) {
      var tagetItems = item.closest('.shop-by-concern-contents').querySelectorAll('.shop-by-concern-image,.shop-by-concern-default-image');
      var target = document.querySelector('#' + item.dataset.blockid);
      item.onmouseover = function() {
        if(tagetItems.length > 0) {
          tagetItems.forEach(function(tagetItem) {
            if (tagetItem == target) {
              tagetItem.classList.remove('hidden');
            } else {
              tagetItem.classList.add('hidden');
            }
          });
        }
      }
    });
    document.addEventListener("mouseover", (event) => {
      var target = event.target;
      if (target != null) {
        if (target.closest('.shop-by-concern-content-items') == null) {
          var tagetItems = document.querySelectorAll('.shop-by-concern-image,.shop-by-concern-default-image');
          tagetItems.forEach(function(tagetItem) {
            if (tagetItem.classList.contains('shop-by-concern-default-image')) {
              tagetItem.classList.remove('hidden');
            } else {
              tagetItem.classList.add('hidden');
            }
          })
        }
      }
    });
  }
}
</script>

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }
  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
  .shop-by-concern-content-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    opacity: .3;
    transition: all .5s ease;
    cursor: pointer;
  }
  @media screen and (max-width: 640px) {
     .shop-by-concern-content-item {
       flex-direction: column;
     }
  }
  .shop-by-concern-content-item .buttons-wrapper {
    opacity: 0;
    visibility: hidden;
    transition: all .5s ease;
  }
  @media screen and (max-width: 640px) {
    .shop-by-concern-content-item .buttons-wrapper {
      padding-bottom: 30px;
      opacity: 1;
      visibility: visible;
    }
  }
  .shop-by-concern-content-item:hover .buttons-wrapper {
    opacity: 1;
    visibility: visible;
  }
  .shop-by-concern-content-item:hover {
    opacity: 1;
  }
  .shop-by-concern-contents.hero-wrapper {
    gap: 30px;
    flex-direction: column-reverse;
  }
  .shop-by-concern-content-items {
    width: 100%;
  }
  .image-wrapper.shop-by-concern-image img, .image-wrapper.shop-by-concern-image svg, .image-wrapper.shop-by-concern-default-image img {
    max-height: 600px;
    width: 100%;
  }
  .shop-by-concern-contents .split-content.hero-content-left {
    width: 100%;
  }
  @media screen and (min-width: 992px) {
    .shop-by-concern-contents.hero-wrapper {
      gap: 30px;
      flex-direction: row;
      align-items: start;
    }
    .shop-by-concern-content-items {
      margin-top: 40px;
    }
    .shop-by-concern-contents .split-content.hero-content-left {
      width: 72%;
    }
    .shop-by-concern-contents .grid-item-wrapper {
      max-width: 50%;
      overflow: hidden;
    }
  }
{%- endstyle -%}
